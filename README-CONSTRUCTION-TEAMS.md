# 施工队管理与派工日期自动化

## 功能概述

本功能实现了施工队管理的完整流程，包括：

1. 创建施工队数据库表和示例数据
2. 支持下拉选择已存在的施工队或手动输入新施工队
3. 自动关联施工队电话信息
4. 自动设置或清空派工日期

## 数据库结构

1. **施工队表 (`construction_teams`)**
   - `id`: UUID 主键
   - `name`: 施工队名称（唯一）
   - `phone`: 电话号码
   - `address`: 地址
   - `status`: 状态（默认"active"）
   - `created_at`: 创建时间
   - `updated_at`: 更新时间

2. **数据库触发器**
   - `update_dispatch_date_trigger`: 当施工队从空变为非空时，自动设置派工日期为当前时间；当施工队从非空变为空时，自动清空派工日期
   - `auto_fill_team_phone_trigger`: 当为客户选择施工队时，自动填充施工队电话
   - `update_customer_team_phone_trigger`: 当施工队电话更新时，自动更新所有关联客户的施工队电话

## 前端实现

1. **可编辑施工队单元格**
   - 下拉选择框显示所有已存在的施工队
   - 支持"添加新施工队"选项，允许手动输入
   - 选择施工队时自动关联电话

2. **可编辑施工队电话单元格**
   - 支持手动编辑电话号码
   - 当电话为空时显示"无电话"提示

## 使用方法

1. 在客户列表页面，双击"施工队"或"施工队电话"单元格开始编辑
2. 从下拉列表选择已有施工队，或选择"添加新施工队"手动输入
3. 如需清空施工队，可以选择"清空施工队"选项
4. 按Enter或点击其他区域保存更改
5. 施工队电话将自动关联，也可手动修改
6. 派工日期将根据施工队值自动设置或清空

## 注意事项

1. 当施工队从空值变为非空值时，自动设置派工日期为当前时间
2. 当施工队从非空值变为空值时，自动清空派工日期
3. 电话号码自动关联，但可以手动覆盖
4. 如需管理施工队，需在数据库中直接操作`construction_teams`表

## 依赖关系

此功能依赖于以下文件：
- `scripts/create_construction_teams_table.js`: 创建施工队表和触发器
- `scripts/auto_dispatch_date.js`: 创建派工日期自动化触发器
- `src/services/api.ts`: 提供施工队数据API
- `src/pages/CustomerList.tsx`: 实现施工队编辑UI 